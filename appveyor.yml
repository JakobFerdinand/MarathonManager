
branches:
  only:
    - master

image: Visual Studio 2019

services:
  - mssql

platform: Any CPU

configuration:
  - Debug
  - Release
  
before_build:
  - nuget restore

build:
  project: MarathonManager.sln

test:
  assemblies:
      only:
      - Core.Test.dll

after_test:
  cmd: publish_win10.bat

artifacts:
  - path: MarathonManager\bin\$(configuration)
    name: MarathonManager

  - path: Publish\UI.TimeRecord
    name: TimeRecord

  - path: Publish\UI.StartRuns
    name: StartRuns

deploy:
  release: MarathonManager %APPVEYOR_BUILD_VERSION%
  description: MarathonManager release %APPVEYOR_BUILD_VERSION%
  provider: GitHub
  auth_token:
    secure: iO5+PhCcDk190CyCB9EBLc+1kD0GWXdJUdQMalcl62xQYSUKLmAJJue1MsAt7WE8
  artifact: MarathonManager
  draft: false
  prerelease: true
